{% extends 'base.html.twig' %}

{# O título da página será o nome do evento vindo do Controller #}
{% block title %}{{ evento.nome }} - GatePass{% endblock %}

{% block main_content %}

    <div class="row mt-4">
        <div class="col-md-6">
            <img src="{{ evento.urlBanner|default('https://via.placeholder.com/600x400?text=GatePass') }}"
                 class="img-fluid rounded shadow-sm"
                 alt="{{ evento.nome }}">
        </div>

        <div class="col-md-6">
            <h1 class="display-5">{{ evento.nome }}</h1>
            <p class="fs-5 text-muted">
                <i class="bi bi-calendar-event"></i> {{ evento.dataHoraInicio|date('d/m/Y \à\s H:i') }}
            </p>
            <p class="fs-5 text-muted">
                <i class="bi bi-geo-alt-fill"></i> {{ evento.local }}
            </p>

            <hr>

            <h4 class="mb-3">Sobre o Evento</h4>
            <p class="lead">{{ evento.descricao|default('Nenhuma descrição fornecida.')|nl2br }}</p>

            <hr>

            <h4 class="mb-3">Ingressos (Lotes)</h4>

            {% if evento.lotes is not empty %}
                <ul class="list-group list-group-flush mb-3">
                    {% for lote in evento.lotes %}
                        {#
                        (Futuramente, adicionaremos regras de negócio aqui,
                         como verificar dataInicioVendas e estoque)
                        #}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <h5 class="mb-1">{{ lote.nome }}</h5>
                                <small class="text-muted">
                                    Preço: {{ lote.preco|format_currency('BRL') }}
                                </small>
                            </div>

                            {# Este é o botão CORRETO, que aponta para o PedidoController #}
                            <a href="{{ path('app_pedido_adicionar', {id: lote.id}) }}" class="btn btn-success">
                                Comprar
                            </a>
                        </li>

                    {% endfor %}
                </ul>
            {% else %}
                <div class="alert alert-warning" role="alert">
                    Nenhum lote de ingresso disponível para este evento no momento.
                </div>
            {% endif %}

        </div>
    </div>

{% endblock %}